{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Invoice - {{ invoice.invoice_number }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root{ --primary:#0f1f4f; --muted:#6b7280; }
        body{font-family:Segoe UI, Tahoma, Arial, sans-serif; color:#111827; padding:24px;}
        .inv-header{ display:flex; justify-content:space-between; align-items:center; margin-bottom:24px; }
        .inv-card{ border:1px solid rgba(15,31,79,0.06); padding:18px; border-radius:8px; background:#fff; }
        .small-muted{ color:var(--muted); font-size:13px; }
    </style>
</head>
<body>
<div class="container">
    <div class="inv-header">
        <div>
            <h3 style="color:var(--primary); margin:0;">Invoice</h3>
            <div class="small-muted">Invoice #: <strong>{{ invoice.invoice_number }}</strong></div>
        </div>
        <div class="text-end small-muted">
            Issued: {{ invoice.issued_at|date:"M d, Y" }}
        </div>
    </div>

    <div class="inv-card">
        <div class="row">
            <div class="col-md-8">
                <h5>Bill To</h5>
                {% with invoice.orders.all|first as first_order %}
                <div>{{ first_order.user.get_full_name|default:first_order.user.username }}</div>
                <div class="small-muted">{{ first_order.shipping_address }}</div>
                <div class="small-muted">Mobile: {{ first_order.mobile }}</div>
                {% endwith %}
            </div>
            <div class="col-md-4 text-end">
                <h5>Amount</h5>
                <div style="font-weight:700; font-size:1.4rem; color:var(--primary);">₹{{ invoice.total }}</div>
                <div class="small-muted">Subtotal: ₹{{ invoice.subtotal }}</div>
                <div class="small-muted">Tax: ₹{{ invoice.tax }}</div>
            </div>
        </div>

        <hr>
        <h6>Order Details</h6>
        {% for ord in invoice.orders.all %}
            <div style="display:grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap:10px; padding:10px 0; border-bottom:1px solid #e5e7eb;">
                <div>
                    <div style="font-weight:600;">{{ ord.product_name }}</div>
                    <div class="small-muted">Order ID: #{{ ord.id }}</div>
                </div>
                <div style="text-align:center;">
                    <div style="font-weight:600;">{{ ord.quantity }}</div>
                    <div class="small-muted">Qty</div>
                </div>
                <div style="text-align:center;">
                    <div style="font-weight:600;">₹{{ ord.price }}</div>
                    <div class="small-muted">Unit</div>
                </div>
                <div style="text-align:right;">
                    <div style="font-weight:600;">₹{{ ord.total_price }}</div>
                    <div class="small-muted">Total</div>
                </div>
            </div>
        {% empty %}
            <div class="small-muted">No associated orders.</div>
        {% endfor %}

        <div class="mt-4 text-end">
            <a href="javascript:window.print()" class="btn btn-outline-dark">Print</a>
            <a href="{% url 'customer_dashboard' %}" class="btn btn-primary ms-2">Back to Orders</a>
        </div>
    </div>
</div>
</body>
</html>